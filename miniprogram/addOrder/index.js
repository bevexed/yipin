"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var order_1 = require("../api/order");
var app = getApp();
var token = wx.getStorageSync('token');
Page({
    data: {
        address: {},
        information: '',
        amount: '',
        note: '',
        pics: []
    },
    onLoad: function (options) {
        this.getAddress();
    },
    write: function (e) {
        this.setData({
            information: e.detail.value
        });
    },
    amount: function (e) {
        this.setData({
            amount: e.detail.value
        });
    },
    noteText: function (e) {
        this.setData({
            note: e.detail.value
        });
    },
    getAddress: function () {
        var _this = this;
        order_1.address().then(function (res) {
            _this.setData({
                address: res.data
            });
        });
    },
    uploadImage: function () {
        var that = this;
        var pics = this.data.pics;
        wx.chooseImage({
            count: 3 - pics.length,
            sizeType: ['original', 'compressed'],
            sourceType: ['album', 'camera'],
            success: function (res) {
                var tempFilePaths = res.tempFilePaths;
                var picAll = pics.concat(tempFilePaths);
                that.setData({
                    pics: picAll
                });
            }
        });
    },
    tijiao: function () {
        var picture = '';
        this.data.pics.map(function (res) {
            picture += res + ',';
        });
        if (this.data.information == '' || this.data.amount == '' || this.data.note == '') {
            wx.showToast({
                title: '请输入必填信息',
                icon: 'none',
                duration: 2000
            });
            return;
        }
        var reg = /^[1-9]\d*$/;
        if (!reg.test(this.data.amount)) {
            wx.showToast({
                title: '请输入正确的下单数量',
                icon: 'none',
                duration: 2000
            });
            return;
        }
        order_1.addOrder(token, this.data.information, this.data.amount, this.data.note, picture).then(function (res) {
            if (res.code == 1) {
                wx.navigateTo({
                    url: '../pages/index/index'
                });
            }
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUdBLHNDQUFnRDtBQUVoRCxJQUFNLEdBQUcsR0FBRyxNQUFNLEVBQVUsQ0FBQztBQUM3QixJQUFNLEtBQUssR0FBRyxFQUFFLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBRXpDLElBQUksQ0FBQztJQUNILElBQUksRUFBRTtRQUNKLE9BQU8sRUFBQyxFQUFFO1FBQ1YsV0FBVyxFQUFDLEVBQUU7UUFDZCxNQUFNLEVBQUMsRUFBRTtRQUNULElBQUksRUFBQyxFQUFFO1FBQ1AsSUFBSSxFQUFDLEVBQUU7S0FDUjtJQUNELE1BQU0sRUFBTixVQUFPLE9BQVk7UUFDakIsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO0lBQ3BCLENBQUM7SUFDRCxLQUFLLFlBQUMsQ0FBQztRQUNOLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxXQUFXLEVBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLO1NBQzNCLENBQUMsQ0FBQTtJQUNILENBQUM7SUFDRCxNQUFNLFlBQUMsQ0FBQztRQUNOLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxNQUFNLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLO1NBQ3ZCLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFDRCxRQUFRLFlBQUMsQ0FBQztRQUNSLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxJQUFJLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLO1NBQ3JCLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxVQUFVLEVBQVY7UUFBQSxpQkFNQztRQUxDLGVBQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxVQUFBLEdBQUc7WUFDaEIsS0FBSSxDQUFDLE9BQVEsQ0FBQztnQkFDWixPQUFPLEVBQUMsR0FBRyxDQUFDLElBQUk7YUFDakIsQ0FBQyxDQUFBO1FBQ0osQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDO0lBRUQsV0FBVyxFQUFYO1FBQ0UsSUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2xCLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBQzVCLEVBQUUsQ0FBQyxXQUFXLENBQUM7WUFDYixLQUFLLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNO1lBQ3RCLFFBQVEsRUFBRSxDQUFDLFVBQVUsRUFBRSxZQUFZLENBQUM7WUFDcEMsVUFBVSxFQUFFLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQztZQUMvQixPQUFPLEVBQVAsVUFBUSxHQUFHO2dCQUVULElBQU0sYUFBYSxHQUFHLEdBQUcsQ0FBQyxhQUFhLENBQUE7Z0JBQ3ZDLElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUM7Z0JBQzFDLElBQUksQ0FBQyxPQUFRLENBQUM7b0JBQ1osSUFBSSxFQUFFLE1BQU07aUJBQ2IsQ0FBQyxDQUFBO1lBQ0osQ0FBQztTQUNGLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxNQUFNO1FBQ0osSUFBSSxPQUFPLEdBQUcsRUFBRSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFDLEdBQUc7WUFDckIsT0FBTyxJQUFJLEdBQUcsR0FBRyxHQUFHLENBQUM7UUFDdkIsQ0FBQyxDQUFDLENBQUE7UUFFRixJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxJQUFJLEVBQUUsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sSUFBSSxFQUFFLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksRUFBRSxFQUFFO1lBQ2pGLEVBQUUsQ0FBQyxTQUFTLENBQUM7Z0JBQ1gsS0FBSyxFQUFFLFNBQVM7Z0JBQ2hCLElBQUksRUFBRSxNQUFNO2dCQUNaLFFBQVEsRUFBRSxJQUFJO2FBQ2YsQ0FBQyxDQUFBO1lBQ0YsT0FBTztTQUNSO1FBRUQsSUFBSSxHQUFHLEdBQUcsWUFBWSxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUM7WUFDOUIsRUFBRSxDQUFDLFNBQVMsQ0FBQztnQkFDWCxLQUFLLEVBQUMsWUFBWTtnQkFDbEIsSUFBSSxFQUFDLE1BQU07Z0JBQ1gsUUFBUSxFQUFDLElBQUk7YUFDZCxDQUFDLENBQUE7WUFDRixPQUFPO1NBQ1I7UUFFRCxnQkFBUSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQSxHQUFHO1lBQ3hGLElBQUcsR0FBRyxDQUFDLElBQUksSUFBSSxDQUFDLEVBQUM7Z0JBQ2YsRUFBRSxDQUFDLFVBQVUsQ0FBQztvQkFDWixHQUFHLEVBQUUsc0JBQXNCO2lCQUM1QixDQUFDLENBQUE7YUFDSDtRQUNILENBQUMsQ0FBQyxDQUFBO0lBQ0osQ0FBQztDQUNGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8vaW5kZXguanNcbi8v6I635Y+W5bqU55So5a6e5L6LXG5pbXBvcnQgeyBJTXlBcHAgfSBmcm9tICcuLi9hcHAnXG5pbXBvcnQgeyBhZGRyZXNzLCBhZGRPcmRlciB9IGZyb20gJy4uL2FwaS9vcmRlcidcblxuY29uc3QgYXBwID0gZ2V0QXBwPElNeUFwcD4oKTtcbmNvbnN0IHRva2VuID0gd3guZ2V0U3RvcmFnZVN5bmMoJ3Rva2VuJyk7XG5cblBhZ2Uoe1xuICBkYXRhOiB7XG4gICAgYWRkcmVzczp7fSxcbiAgICBpbmZvcm1hdGlvbjonJyxcbiAgICBhbW91bnQ6JycsXG4gICAgbm90ZTonJyxcbiAgICBwaWNzOltdXG4gIH0sXG4gIG9uTG9hZChvcHRpb25zOiBhbnkpIHtcbiAgICB0aGlzLmdldEFkZHJlc3MoKTtcbiAgfSxcbiAgd3JpdGUoZSl7XG4gICB0aGlzLnNldERhdGEoe1xuICAgICBpbmZvcm1hdGlvbjplLmRldGFpbC52YWx1ZVxuICAgfSlcbiAgfSxcbiAgYW1vdW50KGUpe1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBhbW91bnQ6IGUuZGV0YWlsLnZhbHVlXG4gICAgfSlcbiAgfSxcbiAgbm90ZVRleHQoZSl7XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIG5vdGU6IGUuZGV0YWlsLnZhbHVlXG4gICAgfSlcbiAgfSxcbiAgLy8g6I635Y+W5Zyw5Z2AXG4gIGdldEFkZHJlc3MoKXtcbiAgICBhZGRyZXNzKCkudGhlbihyZXMgPT4ge1xuICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgIGFkZHJlc3M6cmVzLmRhdGFcbiAgICAgIH0pXG4gICAgfSlcbiAgfSxcbiAgLy8g5LiK5Lyg5Zu+54mHXG4gIHVwbG9hZEltYWdlKCl7XG4gICAgY29uc3QgdGhhdCA9IHRoaXM7XG4gICAgY29uc3QgcGljcyA9IHRoaXMuZGF0YS5waWNzO1xuICAgIHd4LmNob29zZUltYWdlKHtcbiAgICAgIGNvdW50OiAzIC0gcGljcy5sZW5ndGgsXG4gICAgICBzaXplVHlwZTogWydvcmlnaW5hbCcsICdjb21wcmVzc2VkJ10sXG4gICAgICBzb3VyY2VUeXBlOiBbJ2FsYnVtJywgJ2NhbWVyYSddLFxuICAgICAgc3VjY2VzcyhyZXMpIHtcbiAgICAgICAgLy8gdGVtcEZpbGVQYXRo5Y+v5Lul5L2c5Li6aW1n5qCH562+55qEc3Jj5bGe5oCn5pi+56S65Zu+54mHXG4gICAgICAgIGNvbnN0IHRlbXBGaWxlUGF0aHMgPSByZXMudGVtcEZpbGVQYXRoc1xuICAgICAgICBjb25zdCBwaWNBbGwgPSBwaWNzLmNvbmNhdCh0ZW1wRmlsZVBhdGhzKTtcbiAgICAgICAgdGhhdC5zZXREYXRhISh7XG4gICAgICAgICAgcGljczogcGljQWxsXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfSxcbiAgLy8g5o+Q5Lqk6K6i5Y2VXG4gIHRpamlhbygpe1xuICAgIGxldCBwaWN0dXJlID0gJyc7XG4gICAgdGhpcy5kYXRhLnBpY3MubWFwKChyZXMpID0+e1xuICAgICAgcGljdHVyZSArPSByZXMgKyAnLCc7XG4gICAgfSkgXG5cbiAgICBpZiAodGhpcy5kYXRhLmluZm9ybWF0aW9uID09ICcnIHx8IHRoaXMuZGF0YS5hbW91bnQgPT0gJycgfHwgdGhpcy5kYXRhLm5vdGUgPT0gJycpIHtcbiAgICAgIHd4LnNob3dUb2FzdCh7XG4gICAgICAgIHRpdGxlOiAn6K+36L6T5YWl5b+F5aGr5L+h5oGvJyxcbiAgICAgICAgaWNvbjogJ25vbmUnLFxuICAgICAgICBkdXJhdGlvbjogMjAwMFxuICAgICAgfSlcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgcmVnID0gL15bMS05XVxcZCokLztcbiAgICBpZiAoIXJlZy50ZXN0KHRoaXMuZGF0YS5hbW91bnQpKXtcbiAgICAgIHd4LnNob3dUb2FzdCh7XG4gICAgICAgIHRpdGxlOifor7fovpPlhaXmraPnoa7nmoTkuIvljZXmlbDph48nLFxuICAgICAgICBpY29uOidub25lJyxcbiAgICAgICAgZHVyYXRpb246MjAwMFxuICAgICAgfSlcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIFxuICAgIGFkZE9yZGVyKHRva2VuLCB0aGlzLmRhdGEuaW5mb3JtYXRpb24sIHRoaXMuZGF0YS5hbW91bnQsIHRoaXMuZGF0YS5ub3RlLCBwaWN0dXJlKS50aGVuKHJlcyA9PiB7XG4gICAgICBpZihyZXMuY29kZSA9PSAxKXtcbiAgICAgICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICAgICAgdXJsOiAnLi4vcGFnZXMvaW5kZXgvaW5kZXgnXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfVxufSlcbiJdfQ==
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var order_1 = require("../api/order");
var token = wx.getStorageSync('token');
Page({
    data: {
        address: {},
        information: '',
        amount: '',
        note: '',
        pics: []
    },
    onLoad: function () {
        this.getAddress();
    },
    write: function (e) {
        this.setData({
            information: e.detail.value
        });
    },
    amount: function (e) {
        this.setData({
            amount: e.detail.value
        });
    },
    noteText: function (e) {
        this.setData({
            note: e.detail.value
        });
    },
    getAddress: function () {
        var _this = this;
        order_1.address().then(function (res) {
            _this.setData({
                address: res.data
            });
        });
    },
    uploadImage: function () {
        var that = this;
        var pics = this.data.pics;
        wx.chooseImage({
            count: 3 - pics.length,
            sizeType: ['original', 'compressed'],
            sourceType: ['album', 'camera'],
            success: function (res) {
                var tempFilePaths = res.tempFilePaths;
                var picAll = pics.concat(tempFilePaths);
                that.setData({
                    pics: picAll
                });
            }
        });
    },
    tijiao: function () {
        var picture = '';
        this.data.pics.map(function (res) {
            picture += res + ',';
        });
        if (this.data.information == '' || this.data.amount == '' || this.data.note == '') {
            wx.showToast({
                title: '请输入必填信息',
                icon: 'none',
                duration: 2000
            });
            return;
        }
        var reg = /^[1-9]\d*$/;
        if (!reg.test(this.data.amount)) {
            wx.showToast({
                title: '请输入正确的下单数量',
                icon: 'none',
                duration: 2000
            });
            return;
        }
        order_1.addOrder(token, this.data.information, this.data.amount, this.data.note, picture).then(function (res) {
            if (res.code == 1) {
                wx.navigateTo({
                    url: '../pages/index/index'
                });
            }
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUVBLHNDQUFnRDtBQUVoRCxJQUFNLEtBQUssR0FBRyxFQUFFLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBRXpDLElBQUksQ0FBQztJQUNILElBQUksRUFBRTtRQUNKLE9BQU8sRUFBQyxFQUFFO1FBQ1YsV0FBVyxFQUFDLEVBQUU7UUFDZCxNQUFNLEVBQUMsRUFBRTtRQUNULElBQUksRUFBQyxFQUFFO1FBQ1AsSUFBSSxFQUFDLEVBQUU7S0FDUjtJQUNELE1BQU07UUFDSixJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDcEIsQ0FBQztJQUNELEtBQUssRUFBTCxVQUFNLENBQUs7UUFDVixJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osV0FBVyxFQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSztTQUMzQixDQUFDLENBQUE7SUFDSCxDQUFDO0lBQ0QsTUFBTSxFQUFOLFVBQU8sQ0FBSztRQUNWLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixNQUFNLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLO1NBQ3ZCLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFDRCxRQUFRLEVBQVIsVUFBUyxDQUFLO1FBQ1osSUFBSSxDQUFDLE9BQVEsQ0FBQztZQUNaLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUs7U0FDckIsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUVELFVBQVUsRUFBVjtRQUFBLGlCQU1DO1FBTEMsZUFBTyxFQUFFLENBQUMsSUFBSSxDQUFDLFVBQUEsR0FBRztZQUNoQixLQUFJLENBQUMsT0FBUSxDQUFDO2dCQUNaLE9BQU8sRUFBQyxHQUFHLENBQUMsSUFBSTthQUNqQixDQUFDLENBQUE7UUFDSixDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxXQUFXLEVBQVg7UUFDRSxJQUFNLElBQUksR0FBRyxJQUFJLENBQUM7UUFDbEIsSUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDNUIsRUFBRSxDQUFDLFdBQVcsQ0FBQztZQUNiLEtBQUssRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU07WUFDdEIsUUFBUSxFQUFFLENBQUMsVUFBVSxFQUFFLFlBQVksQ0FBQztZQUNwQyxVQUFVLEVBQUUsQ0FBQyxPQUFPLEVBQUUsUUFBUSxDQUFDO1lBQy9CLE9BQU8sRUFBUCxVQUFRLEdBQUc7Z0JBRVQsSUFBTSxhQUFhLEdBQUcsR0FBRyxDQUFDLGFBQWEsQ0FBQTtnQkFFM0MsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQztnQkFDdEMsSUFBSSxDQUFDLE9BQVEsQ0FBQztvQkFDWixJQUFJLEVBQUUsTUFBTTtpQkFDYixDQUFDLENBQUE7WUFDSixDQUFDO1NBQ0YsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUVELE1BQU07UUFDSixJQUFJLE9BQU8sR0FBRyxFQUFFLENBQUM7UUFDakIsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQUMsR0FBRztZQUNyQixPQUFPLElBQUksR0FBRyxHQUFHLEdBQUcsQ0FBQztRQUN2QixDQUFDLENBQUMsQ0FBQTtRQUVGLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLElBQUksRUFBRSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxJQUFJLEVBQUUsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxFQUFFLEVBQUU7WUFDakYsRUFBRSxDQUFDLFNBQVMsQ0FBQztnQkFDWCxLQUFLLEVBQUUsU0FBUztnQkFDaEIsSUFBSSxFQUFFLE1BQU07Z0JBQ1osUUFBUSxFQUFFLElBQUk7YUFDZixDQUFDLENBQUE7WUFDRixPQUFPO1NBQ1I7UUFFRCxJQUFJLEdBQUcsR0FBRyxZQUFZLENBQUM7UUFDdkIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBQztZQUM5QixFQUFFLENBQUMsU0FBUyxDQUFDO2dCQUNYLEtBQUssRUFBQyxZQUFZO2dCQUNsQixJQUFJLEVBQUMsTUFBTTtnQkFDWCxRQUFRLEVBQUMsSUFBSTthQUNkLENBQUMsQ0FBQTtZQUNGLE9BQU87U0FDUjtRQUVELGdCQUFRLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFBLEdBQUc7WUFDeEYsSUFBRyxHQUFHLENBQUMsSUFBSSxJQUFJLENBQUMsRUFBQztnQkFDZixFQUFFLENBQUMsVUFBVSxDQUFDO29CQUNaLEdBQUcsRUFBRSxzQkFBc0I7aUJBQzVCLENBQUMsQ0FBQTthQUNIO1FBQ0gsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy9pbmRleC5qc1xuLy/ojrflj5blupTnlKjlrp7kvotcbmltcG9ydCB7IGFkZHJlc3MsIGFkZE9yZGVyIH0gZnJvbSAnLi4vYXBpL29yZGVyJ1xuXG5jb25zdCB0b2tlbiA9IHd4LmdldFN0b3JhZ2VTeW5jKCd0b2tlbicpO1xuXG5QYWdlKHtcbiAgZGF0YToge1xuICAgIGFkZHJlc3M6e30sXG4gICAgaW5mb3JtYXRpb246JycsXG4gICAgYW1vdW50OicnLFxuICAgIG5vdGU6JycsXG4gICAgcGljczpbXVxuICB9LFxuICBvbkxvYWQoKSB7XG4gICAgdGhpcy5nZXRBZGRyZXNzKCk7XG4gIH0sXG4gIHdyaXRlKGU6YW55KXtcbiAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICBpbmZvcm1hdGlvbjplLmRldGFpbC52YWx1ZVxuICAgfSlcbiAgfSxcbiAgYW1vdW50KGU6YW55KXtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGFtb3VudDogZS5kZXRhaWwudmFsdWVcbiAgICB9KVxuICB9LFxuICBub3RlVGV4dChlOmFueSl7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBub3RlOiBlLmRldGFpbC52YWx1ZVxuICAgIH0pXG4gIH0sXG4gIC8vIOiOt+WPluWcsOWdgFxuICBnZXRBZGRyZXNzKCl7XG4gICAgYWRkcmVzcygpLnRoZW4ocmVzID0+IHtcbiAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICBhZGRyZXNzOnJlcy5kYXRhXG4gICAgICB9KVxuICAgIH0pXG4gIH0sXG4gIC8vIOS4iuS8oOWbvueJh1xuICB1cGxvYWRJbWFnZSgpe1xuICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xuICAgIGNvbnN0IHBpY3MgPSB0aGlzLmRhdGEucGljcztcbiAgICB3eC5jaG9vc2VJbWFnZSh7XG4gICAgICBjb3VudDogMyAtIHBpY3MubGVuZ3RoLFxuICAgICAgc2l6ZVR5cGU6IFsnb3JpZ2luYWwnLCAnY29tcHJlc3NlZCddLFxuICAgICAgc291cmNlVHlwZTogWydhbGJ1bScsICdjYW1lcmEnXSxcbiAgICAgIHN1Y2Nlc3MocmVzKSB7XG4gICAgICAgIC8vIHRlbXBGaWxlUGF0aOWPr+S7peS9nOS4umltZ+agh+etvueahHNyY+WxnuaAp+aYvuekuuWbvueJh1xuICAgICAgICBjb25zdCB0ZW1wRmlsZVBhdGhzID0gcmVzLnRlbXBGaWxlUGF0aHNcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuXHRcdFx0XHRjb25zdCBwaWNBbGwgPSBwaWNzLmNvbmNhdCh0ZW1wRmlsZVBhdGhzKTtcbiAgICAgICAgdGhhdC5zZXREYXRhISh7XG4gICAgICAgICAgcGljczogcGljQWxsXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfSxcbiAgLy8g5o+Q5Lqk6K6i5Y2VXG4gIHRpamlhbygpe1xuICAgIGxldCBwaWN0dXJlID0gJyc7XG4gICAgdGhpcy5kYXRhLnBpY3MubWFwKChyZXMpID0+e1xuICAgICAgcGljdHVyZSArPSByZXMgKyAnLCc7XG4gICAgfSlcblxuICAgIGlmICh0aGlzLmRhdGEuaW5mb3JtYXRpb24gPT0gJycgfHwgdGhpcy5kYXRhLmFtb3VudCA9PSAnJyB8fCB0aGlzLmRhdGEubm90ZSA9PSAnJykge1xuICAgICAgd3guc2hvd1RvYXN0KHtcbiAgICAgICAgdGl0bGU6ICfor7fovpPlhaXlv4Xloavkv6Hmga8nLFxuICAgICAgICBpY29uOiAnbm9uZScsXG4gICAgICAgIGR1cmF0aW9uOiAyMDAwXG4gICAgICB9KVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciByZWcgPSAvXlsxLTldXFxkKiQvO1xuICAgIGlmICghcmVnLnRlc3QodGhpcy5kYXRhLmFtb3VudCkpe1xuICAgICAgd3guc2hvd1RvYXN0KHtcbiAgICAgICAgdGl0bGU6J+ivt+i+k+WFpeato+ehrueahOS4i+WNleaVsOmHjycsXG4gICAgICAgIGljb246J25vbmUnLFxuICAgICAgICBkdXJhdGlvbjoyMDAwXG4gICAgICB9KVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGFkZE9yZGVyKHRva2VuLCB0aGlzLmRhdGEuaW5mb3JtYXRpb24sIHRoaXMuZGF0YS5hbW91bnQsIHRoaXMuZGF0YS5ub3RlLCBwaWN0dXJlKS50aGVuKHJlcyA9PiB7XG4gICAgICBpZihyZXMuY29kZSA9PSAxKXtcbiAgICAgICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICAgICAgdXJsOiAnLi4vcGFnZXMvaW5kZXgvaW5kZXgnXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfVxufSlcbiJdfQ==
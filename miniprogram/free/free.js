"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var index_1 = require("../api/index");
Page({
    data: {
        token: '',
        serial_number: '',
        phone: '',
        code: '',
        list: [],
        array: [],
        list2: [],
        array2: [],
        multiArray: [[], []],
        multiIndex: [0, 0],
        index: 0,
        msgData: '获取验证码',
        time: 60,
        timer: 0,
        active: ''
    },
    onLoad: function () {
        var _this = this;
        wx.getStorage({
            key: 'token',
            success: function (res) {
                console.log(res);
                _this.setData({
                    token: res.data
                });
            }
        });
        this.getPhoneModels();
    },
    bindMultiPickerChange: function (e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        this.setData({
            multiIndex: e.detail.value
        });
        console.log(this.data.multiIndex);
    },
    bindMultiPickerColumnChange: function (e) {
        console.log('修改的列为', e.detail.column, '，值为', e.detail.value);
        if (e.detail.column === 0) {
            var _b = this.data, list = _b.list, array = _b.array;
            this.setData({
                multiArray: [array, list[e.detail.value]["subclass"].map(function (item) { return item.name; })]
            });
        }
    },
    input: function (e) {
        var _this_1 = this;
        var _b;
        console.log(e);
        var label = e.target.dataset.type;
        var value = e.detail.detail.value;
        console.log(value);
        this.setData((_b = {},
            _b[label] = value,
            _b), function () { return _this_1.doMerchantExist(); });
        console.log(label, value);
    },
    doMerchantExist: function () {
        if (this.data.serial_number.length < 5) {
            return;
        }
        index_1.reqMerchantExist(this.data.serial_number).then(function (res) {
            console.log(res);
            wx.showToast({
                icon: "none",
                title: res === 0 ? '商家编号不存在' : '商家存在'
            });
        });
    },
    getPhoneModels: function () {
        var _this_1 = this;
        index_1.reqPhoneModels().then(function (res) {
            if (res.code === 1) {
                console.log('get-phone-models', res);
                _this_1.setData({
                    list: res.data,
                    array: res.data.map(function (item) { return item.name; }),
                    list2: res.data[0].subclass,
                    array2: res.data[0].subclass.map(function (item) { return item.name; }),
                    multiArray: [res.data.map(function (item) { return item.name; }), res.data[0].subclass.map(function (item) { return item.name; })]
                });
            }
        });
    },
    changeCode: function (e) {
        console.log(e);
        this.setData({
            code: e.detail.value
        });
        console.log(this.data.code);
    },
    doSendMsg: function () {
        var _this = this;
        var _a = this.data, time = _a.time, timer = _a.timer;
        if (timer !== 0) {
            return;
        }
        var mobile = this.data.phone;
        var type = 'SMS_166320348';
        index_1.sendMsg({ type: type, mobile: mobile }).then(function (res) {
            if (res.code === 1) {
                timer = setInterval(function () {
                    if (time === 0) {
                        clearInterval(timer);
                        _this.setData({
                            timer: 0,
                            time: 60,
                            msgData: '获取验证码',
                            active: ''
                        });
                        return;
                    }
                    time--;
                    _this.setData({
                        msgData: time + 's',
                        timer: timer,
                        active: 'active'
                    });
                }, 1000);
            }
        });
    },
    getFreeFilm: function () {
        var _b = this.data, token = _b.token, multiArray = _b.multiArray, multiIndex = _b.multiIndex, serial_number = _b.serial_number, phone = _b.phone, code = _b.code;
        var phone_model = multiArray[1][multiIndex[1]];
        console.log(phone_model);
        index_1.reqGetFreeFilm({ token: token, phone_model: phone_model, serial_number: serial_number, phone: phone, code: code }).then(function (res) {
            wx.showToast({
                title: res.message,
                icon: 'none',
                duration: 2000
            });
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnJlZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImZyZWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxzQ0FBdUY7QUFFdkYsSUFBSSxDQUFDO0lBRUosSUFBSSxFQUFFO1FBRUwsS0FBSyxFQUFFLEVBQUU7UUFDVCxhQUFhLEVBQUMsRUFBRTtRQUNoQixLQUFLLEVBQUMsRUFBRTtRQUNSLElBQUksRUFBQyxFQUFFO1FBRVAsSUFBSSxFQUFDLEVBQUU7UUFDUCxLQUFLLEVBQUUsRUFBRTtRQUNULEtBQUssRUFBRSxFQUFFO1FBQ1QsTUFBTSxFQUFFLEVBQUU7UUFFVixVQUFVLEVBQUUsQ0FBQyxFQUFFLEVBQUMsRUFBRSxDQUFDO1FBQ25CLFVBQVUsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFFbEIsS0FBSyxFQUFFLENBQUM7UUFFUixPQUFPLEVBQUUsT0FBTztRQUNoQixJQUFJLEVBQUUsRUFBRTtRQUNSLEtBQUssRUFBRSxDQUFDO1FBQ1IsTUFBTSxFQUFFLEVBQUU7S0FFVjtJQUVELE1BQU0sRUFBTjtRQUVDLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQztRQUNqQixFQUFFLENBQUMsVUFBVSxDQUFDO1lBQ2IsR0FBRyxFQUFFLE9BQU87WUFDWixPQUFPLEVBQVAsVUFBUSxHQUFHO2dCQUNWLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ2pCLEtBQUssQ0FBQyxPQUFRLENBQUM7b0JBQ2QsS0FBSyxFQUFFLEdBQUcsQ0FBQyxJQUFJO2lCQUNmLENBQUMsQ0FBQTtZQUNILENBQUM7U0FDRCxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7SUFDdkIsQ0FBQztJQUVELHFCQUFxQixFQUFFLFVBQVUsQ0FBTTtRQUN0QyxPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQixFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDakQsSUFBSSxDQUFDLE9B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QUNYLFFBQVEsRUFBQyxJQUFJO2FBQ2QsQ0FBQyxDQUFBO1FBQ1AsQ0FBQyxDQUNELENBQUE7SUFDRixDQUFDO0NBRUQsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtyZXFHZXRGcmVlRmlsbSwgcmVxTWVyY2hhbnRFeGlzdCwgcmVxUGhvbmVNb2RlbHMsIHNlbmRNc2d9IGZyb20gXCIuLi9hcGkvaW5kZXhcIjtcblxuUGFnZSh7XG5cblx0ZGF0YToge1xuXG5cdFx0dG9rZW46ICcnLFxuXHRcdHNlcmlhbF9udW1iZXI6JycsXG5cdFx0cGhvbmU6JycsXG5cdFx0Y29kZTonJyxcblxuXHRcdGxpc3Q6W10sXG5cdFx0YXJyYXk6IFtdLFxuXHRcdGxpc3QyOiBbXSxcblx0XHRhcnJheTI6IFtdLFxuXG5cdFx0bXVsdGlBcnJheTogW1tdLFtdXSxcblx0XHRtdWx0aUluZGV4OiBbMCwgMF0sXG5cblx0XHRpbmRleDogMCxcblxuXHRcdG1zZ0RhdGE6ICfojrflj5bpqozor4HnoIEnLFxuXHRcdHRpbWU6IDYwLFxuXHRcdHRpbWVyOiAwLFxuXHRcdGFjdGl2ZTogJydcblxuXHR9LFxuXG5cdG9uTG9hZCgpIHtcblx0XHQvLyDor7vlj5Z0b2tlblxuXHRcdGxldCBfdGhpcyA9IHRoaXM7XG5cdFx0d3guZ2V0U3RvcmFnZSh7XG5cdFx0XHRrZXk6ICd0b2tlbicsXG5cdFx0XHRzdWNjZXNzKHJlcykge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhyZXMpO1xuXHRcdFx0XHRfdGhpcy5zZXREYXRhISh7XG5cdFx0XHRcdFx0dG9rZW46IHJlcy5kYXRhXG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLmdldFBob25lTW9kZWxzKCk7XG5cdH0sXG5cblx0YmluZE11bHRpUGlja2VyQ2hhbmdlOiBmdW5jdGlvbiAoZTogYW55KSB7XG5cdFx0Y29uc29sZS5sb2coJ3BpY2tlcuWPkemAgemAieaLqeaUueWPmO+8jOaQuuW4puWAvOS4uicsIGUuZGV0YWlsLnZhbHVlKTtcblx0XHR0aGlzLnNldERhdGEhKHtcblx0XHRcdG11bHRpSW5kZXg6IGUuZGV0YWlsLnZhbHVlXG5cdFx0fSlcblx0XHRjb25zb2xlLmxvZyh0aGlzLmRhdGEubXVsdGlJbmRleCk7XG5cdH0sXG5cblx0YmluZE11bHRpUGlja2VyQ29sdW1uQ2hhbmdlOiBmdW5jdGlvbiAoZTogYW55KSB7XG5cdFx0Y29uc29sZS5sb2coJ+S/ruaUueeahOWIl+S4uicsIGUuZGV0YWlsLmNvbHVtbiwgJ++8jOWAvOS4uicsIGUuZGV0YWlsLnZhbHVlKTtcblx0XHRpZiAoZS5kZXRhaWwuY29sdW1uID09PSAwKSB7XG5cdFx0XHRsZXQge2xpc3QsIGFycmF5fSA9IHRoaXMuZGF0YTtcblx0XHRcdHRoaXMuc2V0RGF0YSEoe1xuXHRcdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRcdG11bHRpQXJyYXk6IFthcnJheSwgbGlzdFtlLmRldGFpbC52YWx1ZV1bXCJzdWJjbGFzc1wiXS5tYXAoaXRlbSA9PiBpdGVtLm5hbWUpXVxuXHRcdFx0fSlcblx0XHR9XG5cdH0sXG5cblxuXHRpbnB1dChlOiBhbnkpIHtcblx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHRjb25zdCBsYWJlbCA9IGUudGFyZ2V0LmRhdGFzZXQudHlwZTtcblx0XHRjb25zdCB2YWx1ZSA9IGUuZGV0YWlsLmRldGFpbC52YWx1ZTtcblx0XHRjb25zb2xlLmxvZyh2YWx1ZSk7XG5cdFx0dGhpcy5zZXREYXRhISh7XG5cdFx0XHRbbGFiZWxdOiB2YWx1ZVxuXHRcdH0sICgpID0+IHRoaXMuZG9NZXJjaGFudEV4aXN0KCkpO1xuXG5cdFx0Y29uc29sZS5sb2cobGFiZWwsIHZhbHVlKTtcblx0fSxcblxuXHRkb01lcmNoYW50RXhpc3QoKSB7XG5cdFx0aWYgKHRoaXMuZGF0YS5zZXJpYWxfbnVtYmVyLmxlbmd0aCA8IDUpIHtcblx0XHRcdHJldHVyblxuXHRcdH1cblx0XHRyZXFNZXJjaGFudEV4aXN0KHRoaXMuZGF0YS5zZXJpYWxfbnVtYmVyKS50aGVuKFxuXHRcdFx0KHJlczogYW55KSA9PiB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKHJlcyk7XG5cdFx0XHRcdHd4LnNob3dUb2FzdCh7XG5cdFx0XHRcdFx0aWNvbjogXCJub25lXCIsXG5cdFx0XHRcdFx0dGl0bGU6IHJlcyA9PT0gMCA/ICfllYblrrbnvJblj7fkuI3lrZjlnKgnIDogJ+WVhuWutuWtmOWcqCdcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHQpXG5cdH0sXG5cblx0Z2V0UGhvbmVNb2RlbHMoKSB7XG5cdFx0cmVxUGhvbmVNb2RlbHMoKS50aGVuKFxuXHRcdFx0cmVzID0+IHtcblx0XHRcdFx0aWYgKHJlcy5jb2RlID09PSAxKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ2dldC1waG9uZS1tb2RlbHMnLCByZXMpO1xuXHRcdFx0XHRcdHRoaXMuc2V0RGF0YSEoe1xuXHRcdFx0XHRcdFx0bGlzdDogcmVzLmRhdGEsXG5cdFx0XHRcdFx0XHRhcnJheTogcmVzLmRhdGEubWFwKChpdGVtOiBhbnkpID0+IGl0ZW0ubmFtZSksXG5cdFx0XHRcdFx0XHRsaXN0MjogcmVzLmRhdGFbMF0uc3ViY2xhc3MsXG5cdFx0XHRcdFx0XHRhcnJheTI6IHJlcy5kYXRhWzBdLnN1YmNsYXNzLm1hcCgoaXRlbTogYW55KSA9PiBpdGVtLm5hbWUpLFxuXHRcdFx0XHRcdFx0bXVsdGlBcnJheTogW3Jlcy5kYXRhLm1hcCgoaXRlbTogYW55KSA9PiBpdGVtLm5hbWUpLCByZXMuZGF0YVswXS5zdWJjbGFzcy5tYXAoKGl0ZW06IGFueSkgPT4gaXRlbS5uYW1lKV1cblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0KVxuXHR9LFxuXG5cdGNoYW5nZUNvZGU6IGZ1bmN0aW9uIChlOiBhbnkpIHtcblx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHR0aGlzLnNldERhdGEhKHtcblx0XHRcdGNvZGU6IGUuZGV0YWlsLnZhbHVlXG5cdFx0fSk7XG5cdFx0Y29uc29sZS5sb2codGhpcy5kYXRhLmNvZGUpO1xuXHR9LFxuXHRkb1NlbmRNc2c6IGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdHZhciBfYSA9IHRoaXMuZGF0YSwgdGltZSA9IF9hLnRpbWUsIHRpbWVyID0gX2EudGltZXI7XG5cdFx0aWYgKHRpbWVyICE9PSAwKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gdG9kbzog5re75Yqg5a6e5pe255uR5o6nXG5cblx0XHRjb25zdCBtb2JpbGUgPSB0aGlzLmRhdGEucGhvbmU7XG5cdFx0Y29uc3QgdHlwZSA9ICdTTVNfMTY2MzIwMzQ4Jztcblx0XHRzZW5kTXNnKHt0eXBlLCBtb2JpbGV9KS50aGVuKFxuXHRcdFx0KHJlczogYW55KSA9PiB7XG5cdFx0XHRcdGlmIChyZXMuY29kZSA9PT0gMSkge1xuXG5cdFx0XHRcdFx0dGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRpZiAodGltZSA9PT0gMCkge1xuXHRcdFx0XHRcdFx0XHRjbGVhckludGVydmFsKHRpbWVyKTtcblx0XHRcdFx0XHRcdFx0X3RoaXMuc2V0RGF0YSEoe1xuXHRcdFx0XHRcdFx0XHRcdHRpbWVyOiAwLFxuXHRcdFx0XHRcdFx0XHRcdHRpbWU6IDYwLFxuXHRcdFx0XHRcdFx0XHRcdG1zZ0RhdGE6ICfojrflj5bpqozor4HnoIEnLFxuXHRcdFx0XHRcdFx0XHRcdGFjdGl2ZTogJydcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHRpbWUtLTtcblx0XHRcdFx0XHRcdF90aGlzLnNldERhdGEhKHtcblx0XHRcdFx0XHRcdFx0bXNnRGF0YTogdGltZSArICdzJyxcblx0XHRcdFx0XHRcdFx0dGltZXI6IHRpbWVyLFxuXHRcdFx0XHRcdFx0XHRhY3RpdmU6ICdhY3RpdmUnXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9LCAxMDAwKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdCk7XG5cblxuXHR9LFxuXG5cdGdldEZyZWVGaWxtKCkge1xuXHRcdGNvbnN0IHt0b2tlbixtdWx0aUFycmF5LG11bHRpSW5kZXgsc2VyaWFsX251bWJlcixwaG9uZSxjb2RlfSA9IHRoaXMuZGF0YTtcblxuXHRcdGxldCBwaG9uZV9tb2RlbCA9IG11bHRpQXJyYXlbMV1bbXVsdGlJbmRleFsxXV07XG5cdFx0Y29uc29sZS5sb2cocGhvbmVfbW9kZWwpO1xuXHRcdHJlcUdldEZyZWVGaWxtKHt0b2tlbixwaG9uZV9tb2RlbCxzZXJpYWxfbnVtYmVyLHBob25lLGNvZGV9KS50aGVuKFxuXHRcdFx0KHJlczphbnkpID0+IHtcblx0XHRcdFx0d3guc2hvd1RvYXN0KHtcbiAgICAgICAgICB0aXRsZTpyZXMubWVzc2FnZSxcbiAgICAgICAgICBpY29uOidub25lJyxcbiAgICAgICAgICBkdXJhdGlvbjoyMDAwXG4gICAgICAgIH0pXG5cdFx0XHR9XG5cdFx0KVxuXHR9XG5cbn0pO1xuIl19